server:
  port: 8082
  servlet:
    context-path: /api/business
    encoding:
      charset: UTF-8
      enabled: true
      force: true

spring:
  application:
    name: business-api
  web:
    cors:
      allowed-origins: "http://localhost:3000"
      allowed-methods: GET, POST, PUT, DELETE, PATCH, OPTIONS  
      allowed-headers: "*"
      allow-credentials: true
    encoding:
      charset: UTF-8
      enabled: true
      force: true
  
  # Configuração PostgreSQL
  datasource:
    url: jdbc:postgresql://localhost:5432/glojas_business
    username: glojas_user
    password: F1e0r8n0#1
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      pool-name: BusinessHikariPool
  
  # Configuração JPA/Hibernate
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
    open-in-view: false

    # Configuração Flyway
  flyway:
    enabled: true
    baseline-on-migrate: true
    validate-on-migrate: false  # Temporariamente desabilitado para resolver checksum mismatch
    locations: classpath:db/migration
    schemas: public
    baseline-version: 0
    clean-disabled: false
    out-of-order: true
    ignore-missing-migrations: true
    ignore-ignored-migrations: true
    ignore-pending-migrations: false
    ignore-future-migrations: true
  
  # Configurações JWT
  jwt:
    secret: Z2xvamFzLXNlY3JldC1rZXktMjAyNC12ZXJ5LXNlY3VyZS1zdHJpbmctY2hhbmdlLWluLXByb2R1Y3Rpb24tYXQtbGVhc3QtNjQtY2hhcmFjdGVycy1sb25n
    expiration: 86400000 # 24 horas em millisegundos
    
  # Configurações Email (para reset de senha)
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${EMAIL_USERNAME:}
    password: ${EMAIL_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true

# Actuator para health checks
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: always

logging:
  level:
    com.sysconard.business: DEBUG
    org.springframework.security: DEBUG
    org.flywaydb: DEBUG
    root: INFO
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Configurações para integração com Legacy API
legacy-api:
  base-url: http://localhost:8081
  context-path: /api/legacy
  timeout: 30

# Configurações para sincronização de vendas diárias
sync:
  daily-sales:
    enabled: true
    batch-size: 1000
    retry-attempts: 3
    timeout: 30s
    schedule:
      enabled: true
      cron: "0 0 1 * * *"  # Todo dia às 01:00 AM
    weekly:
      enabled: false
      cron: "0 0 2 * * SUN"  # Todo domingo às 02:00 AM